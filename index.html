<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Linq - News & Market</title>
    <link href="https://fonts.googleapis.com/css2?family=Lexend:wght@400;700&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Lexend', sans-serif;
            font-weight: 400;
            background-color: #ffffff;
            color: #333333;
        }
        strong {
            font-weight: inherit;
        }
        .terms-privacy-content {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: #ffffff;
            padding: 2rem;
            border-radius: 12px;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.5);
            z-index: 60;
            color: #333333;
        }
        .close-btn {
            position: absolute;
            top: 1rem;
            right: 1rem;
            font-size: 1.5rem;
            cursor: pointer;
            color: #666666;
            transition: color 0.2s ease;
        }
        .close-btn:hover {
            color: #000000;
        }
        article {
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            background: #f9f9f9;
        }
        article:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
        }
        .nav-link {
            transition: color 0.2s ease;
            color: #333333;
        }
        .nav-link:hover {
            color: #60a5fa;
        }
        .favorite-btn {
            transition: color 0.2s ease, transform 0.2s ease;
        }
        .favorite-btn:hover {
            color: #f59e0b;
            transform: scale(1.2);
        }
        .favorited {
            color: #f59e0b;
        }
        .filter-panel {
            height: fit-content;
            background: #ffffff;
            border-radius: 2rem;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            order: 2; /* Positions filter on the right */
        }
        .category-tag {
            display: inline-block;
            background: #e5e5e5;
            color: #333333;
            font-size: 0.75rem;
            font-weight: 500;
            padding: 0.25rem 0.5rem;
            border-radius: 9999px;
            margin-left: 0.5rem;
        }
        .news-image {
            width: 150px;
            height: 100px;
            object-fit: cover;
            display: block;
            transition: transform 0.3s ease;
        }
        .news-image:hover {
            transform: scale(1.05);
        }
        .tagline {
            text-align: center;
            font-size: 2.5rem;
            color: #2563eb;
        }
        .tagline .highlight {
            color: #000000;
        }
        .market-section {
            background: #ffffff;
            padding: 1.5rem;
            margin-top: 2rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            border-radius: 8px;
        }
        .market-tabs {
            display: flex;
            gap: 1rem;
            margin-bottom: 1rem;
        }
        .market-tab {
            cursor: pointer;
            color: #666666;
            padding: 0.5rem 1rem;
            transition: color 0.2s ease;
        }
        .market-tab:hover, .market-tab.active {
            color: #000000;
        }
        .market-content {
            display: none;
        }
        .market-content.active {
            display: block;
        }
        .market-table {
            width: 100%;
            border-collapse: collapse;
        }
        .market-table th, .market-table td {
            padding: 0.75rem;
            text-align: right;
            border-bottom: 1px solid #e5e5e5;
        }
        .market-table th:first-child, .market-table td:first-child {
            text-align: left;
            color: #333333;
        }
        .positive {
            color: #10b981;
        }
        .negative {
            color: #ef4444;
        }
        .ticker-banner {
            background: #333333;
            color: #ffffff;
            padding: 0.75rem 0;
            overflow: hidden;
            white-space: nowrap;
            position: relative;
            top: 0;
            width: 100%;
            z-index: 40; /* Below nav (z-50), above content */
            margin-top: 64px; /* Offset for fixed nav height */
        }
        .ticker-content {
            display: inline-block;
            white-space: nowrap;
            animation: ticker-scroll 80s linear infinite;
        }
        @keyframes ticker-scroll {
            0% { transform: translateX(100%); }
            100% { transform: translateX(-100%); }
        }
        .ticker-item {
            display: inline-block;
            margin-right: 2rem;
        }
        @media (max-width: 768px) {
            .tagline {
                font-size: 1.75rem;
            }
            .market-tabs {
                flex-direction: column;
            }
            .market-tab {
                padding: 0.25rem;
            }
            main {
                flex-direction: column;
            }
            .filter-panel {
                order: 0; /* Stack filter above news on mobile */
                width: 100%;
                max-width: none;
            }
            #news {
                order: 1;
            }
            .ticker-banner {
                margin-top: 56px; /* Adjust for smaller nav on mobile */
            }
        }
    </style>
</head>
<body>
    <script type="text/javascript">
        var gk_isXlsx = false;
        var gk_xlsxFileLookup = {};
        var gk_fileData = {};
        function filledCell(cell) {
            return cell !== '' && cell != null;
        }
        function loadFileData(filename) {
            if (gk_isXlsx && gk_xlsxFileLookup[filename]) {
                try {
                    var workbook = XLSX.read(gk_fileData[filename], { type: 'base64' });
                    var firstSheetName = workbook.SheetNames[0];
                    var worksheet = workbook.Sheets[firstSheetName];
                    var jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1, blankrows: false, defval: '' });
                    var filteredData = jsonData.filter(row => row.some(filledCell));
                    var headerRowIndex = filteredData.findIndex((row, index) =>
                        row.filter(filledCell).length >= filteredData[index + 1]?.filter(filledCell).length
                    );
                    if (headerRowIndex === -1 || headerRowIndex > 25) {
                        headerRowIndex = 0;
                    }
                    var csv = XLSX.utils.aoa_to_sheet(filteredData.slice(headerRowIndex));
                    csv = XLSX.utils.sheet_to_csv(csv, { header: 1 });
                    return csv;
                } catch (e) {
                    console.error(e);
                    return "";
                }
            }
            return gk_fileData[filename] || "";
        }
    </script>

    <nav class="bg-white py-4 shadow fixed top-0 left-0 w-full z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 flex justify-between items-center">
            <a href="#" class="text-4xl text-black">Linq</a>
            <div class="flex items-center space-x-6">
                <a href="#news" class="nav-link">News</a>
                <a href="#favorites" class="nav-link">Favorites</a>
                <a href="community.html" class="nav-link">Community</a>
            </div>
        </div>
    </nav>

    <div class="ticker-banner">
        <div class="ticker-content" id="tickerContent"></div>
    </div>

    <div class="tagline text-4xl py-10">
        The <span class="highlight">Linq</span> to your Energy News
    </div>

    <section class="market-section max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="market-tabs">
            <div id="tabCommodities" class="market-tab active">Commodities</div>
            <div id="tabUS" class="market-tab">Equities</div>
            <div id="tabTreasuries" class="market-tab">Treasuries</div>
        </div>
        <div id="marketCommoditiesContent" class="market-content active">
            <table class="market-table" id="commoditiesTable">
                <tr>
                    <th>WTI Crude</th>
                    <td id="wti-crude-price">Loading...</td>
                    <td id="wti-crude-change">Loading...</td>
                    <td id="wti-crude-percent">Loading...</td>
                </tr>
                <tr>
                    <th>Brent Crude</th>
                    <td id="brent-crude-price">Loading...</td>
                    <td id="brent-crude-change">Loading...</td>
                    <td id="brent-crude-percent">Loading...</td>
                </tr>
                <tr>
                    <th>RBOB Gasoline</th>
                    <td id="rbob-gasoline-price">Loading...</td>
                    <td id="rbob-gasoline-change">Loading...</td>
                    <td id="rbob-gasoline-percent">Loading...</td>
                </tr>
                <tr>
                    <th>Natural Gas</th>
                    <td id="natural-gas-price">Loading...</td>
                    <td id="natural-gas-change">Loading...</td>
                    <td id="natural-gas-percent">Loading...</td>
                </tr>
                <tr>
                    <th>Heating Oil</th>
                    <td id="heating-oil-price">Loading...</td>
                    <td id="heating-oil-change">Loading...</td>
                    <td id="heating-oil-percent">Loading...</td>
                </tr>
            </table>
        </div>
        <div id="marketUSContent" class="market-content">
            <table class="market-table">
                <tr>
                    <th>Dow Jones</th>
                    <td>41,317.43</td>
                    <td>564.47</td>
                    <td class="positive">+1.39%</td>
                </tr>
                <tr>
                    <th>S&P 500</th>
                    <td>5,686.68</td>
                    <td>82.54</td>
                    <td class="positive">+1.47%</td>
                </tr>
                <tr>
                    <th>Nasdaq</th>
                    <td>17,977.73</td>
                    <td>266.99</td>
                    <td class="positive">+1.51%</td>
                </tr>
            </table>
        </div>
        <div id="marketTreasuriesContent" class="market-content">
            <table class="market-table">
                <tr>
                    <th>10-Year Treasury Yield</th>
                    <td>4.40%</td>
                    <td>0.02</td>
                    <td class="positive">+0.00%</td>
                </tr>
                <tr>
                    <th>2-Year Treasury Yield</th>
                    <td>4.15%</td>
                    <td>0.01</td>
                    <td class="positive">+0.00%</td>
                </tr>
                <tr>
                    <th>30-Year Treasury Yield</th>
                    <td>4.65%</td>
                    <td>0.03</td>
                    <td class="positive">+0.00%</td>
                </tr>
            </table>
        </div>
    </section>

    <div id="termsContent" class="terms-privacy-content">
        <span class="close-btn" onclick="closeTerms()">×</span>
        <h2 class="text-2xl text-gray-800 mb-4">Terms of Service</h2>
        <p>Welcome to Linq. By accessing or using our website, you agree to comply with and be bound by the following terms and conditions. These terms govern your use of the site and any services provided.</p>
        <p class="mt-4">1. <strong>Acceptance of Terms</strong>: By using this site, you accept these terms in full. If you disagree, please do not use the site.</p>
        <p class="mt-2">2. <strong>User Conduct</strong>: You agree not to use the site for illegal or unauthorized purposes.</p>
        <p class="mt-2">3. <strong>Content Ownership</strong>: All content on this site is owned by Linq or its licensors unless otherwise stated.</p>
        <p class="mt-2">4. <strong>Limitation of Liability</strong>: We are not liable for any indirect or consequential damages arising from your use of the site.</p>
        <p class="mt-2">For the most current version, please contact us at <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="4636342f3027253f062a2f28376825292b">[email protected]</a>.</p>
    </div>
    <div id="privacyContent" class="terms-privacy-content">
        <span class="close-btn" onclick="closePrivacy()">×</span>
        <h2 class="text-2xl text-gray-800 mb-4">Privacy Policy</h2>
        <p>At Linq, we are committed to protecting your privacy. This policy outlines how we collect, use, and safeguard your information.</p>
        <p class="mt-4">1. <strong>Information Collection</strong>: We collect personal information such as your name and email when you sign up or submit articles.</p>
        <p class="mt-2">2. <strong>Use of Information</strong>: Your data is used to personalize your experience and improve our services.</p>
        <p class="mt-2">3. <strong>Data Security</strong>: We implement reasonable measures to protect your information from unauthorized access.</p>
        <p class="mt-2">4. <strong>Third-Party Sharing</strong>: We do not sell or share your personal data with third parties except as required by law.</p>
        <p class="mt-2">For questions, contact us at <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="4636342f3027253f062a2f28376825292b">[email protected]</a>.</p>
    </div>

    <main class="max-w-7xl mx-auto pt-8 sm:px-6 lg:px-8 flex flex-wrap gap-6">
        <section id="news" class="flex-1 order-1">
            <h2 class="text-3xl text-gray-800 mb-6">Latest News</h2>
            <div id="newsGrid" class="space-y-6"></div>
        </section>
        <aside class="filter-panel bg-white rounded-2xl shadow-xl p-6 w-80 order-2">
            <h2 class="text-2xl font-semibold text-center text-gray-800 mb-6">Filter by Category</h2>
            <div id="categoryList" class="space-y-3">
                <button class="category w-full py-2 rounded-lg border border-gray-300 text-gray-800 font-medium transition-all shadow-sm hover:shadow-md" data-category="Company News">Company News</button>
                <button class="category w-full py-2 rounded-lg border border-gray-300 text-gray-800 font-medium transition-all shadow-sm hover:shadow-md" data-category="Power">Power</button>
                <button class="category w-full py-2 rounded-lg border border-gray-300 text-gray-800 font-medium transition-all shadow-sm hover:shadow-md" data-category="Crude Oil">Crude Oil</button>
                <button class="category w-full py-2 rounded-lg border border-gray-300 text-gray-800 font-medium transition-all shadow-sm hover:shadow-md" data-category="Natural Gas">Natural Gas</button>
                <button class="category w-full py-2 rounded-lg border border-gray-300 text-gray-800 font-medium transition-all shadow-sm hover:shadow-md" data-category="Petrochemicals">Petrochemicals</button>
                <button class="category w-full py-2 rounded-lg border border-gray-300 text-gray-800 font-medium transition-all shadow-sm hover:shadow-md" data-category="Renewables">Renewables</button>
                <button class="category w-full py-2 rounded-lg border border-gray-300 text-gray-800 font-medium transition-all shadow-sm hover:shadow-md" data-category="Earnings">Earnings</button>
            </div>
        </aside>
        <section id="favorites" class="hidden py-10 w-full order-3">
            <h2 class="text-3xl text-gray-800 mb-6">Your Favorited Articles</h2>
            <div id="favoritesGrid" class="space-y-6"></div>
        </section>
    </main>

    <footer class="bg-white text-gray-600 py-6 shadow">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 flex flex-col md:flex-row justify-between items-center">
            <p>© 2025 Linq. All rights reserved.</p>
            <div class="mt-4 md:mt-0 space-x-4">
                <a href="#terms" class="hover:text-gray-800 transition-colors" onclick="showTerms(event)">Terms of Service</a>
                <a href="#privacy" class="hover:text-gray-800 transition-colors" onclick="showPrivacy(event)">Privacy Policy</a>
                <a href="#" class="hover:text-gray-800 transition-colors">Contact Us</a>
            </div>
        </div>
    </footer>

    <script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script>
    <script>
        const FINNHUB_API_KEY = 'd0d0dlpr01qm2sk76g3gd0d0dlpr01qm2sk76g40';
        const ENERGY_STOCKS = [
            'XOM', 'CVX', 'COP', 'OXY', 'SLB', 'HAL', 'PSX', 'VLO', 'MPC', 'BKR',
            'KMI', 'WMB', 'PXD', 'EOG', 'HES', 'DVN', 'APA', 'FANG', 'CHRD', 'CTRA',
            'MTDR', 'CLR', 'SM', 'CIVI', 'HP'
        ];

        async function fetchFinnhubQuote(symbol) {
            const url = `https://finnhub.io/api/v1/quote?symbol=${symbol}&token=${FINNHUB_API_KEY}`;
            try {
                const response = await fetch(url);
                const data = await response.json();
                const price = data.c;
                const change = data.d;
                const percent = data.dp;
                return { price, change, percent };
            } catch (err) {
                console.error(`Error fetching ${symbol} from Finnhub:`, err);
                return { price: 'N/A', change: 'N/A', percent: 'N/A' };
            }
        }

        async function updateTickerBanner() {
            const tickerContent = document.getElementById('tickerContent');
            tickerContent.innerHTML = '';
            for (const symbol of ENERGY_STOCKS) {
                const data = await fetchFinnhubQuote(symbol);
                const changeClass = data.percent !== 'N/A' ? (data.percent >= 0 ? 'positive' : 'negative') : '';
                const tickerItem = document.createElement('span');
                tickerItem.className = 'ticker-item';
                tickerItem.innerHTML = `${symbol}: $${data.price} <span class="${changeClass}">${data.percent !== 'N/A' ? `${data.percent >= 0 ? '+' : ''}${data.percent.toFixed(2)}%` : 'N/A'}</span>`;
                tickerContent.appendChild(tickerItem);
            }
            const originalContent = tickerContent.innerHTML;
            tickerContent.innerHTML += originalContent;
        }

        async function fetchCommodityData(symbol) {
            const url = `https://www.alphavantage.co/query?function=TIME_SERIES_INTRADAY&symbol=${symbol}&interval=5min&apikey=S9IXH1J5H7M9SCIL`;
            try {
                const response = await fetch(url);
                if (!response.ok) throw new Error('Network response was not ok');
                const data = await response.json();
                const latest = data['Time Series (5min)'][Object.keys(data['Time Series (5min)'])[0]];
                const price = parseFloat(latest['4. close']);
                const prevTime = Object.keys(data['Time Series (5min)'])[1];
                const prevPrice = prevTime ? parseFloat(data['Time Series (5min)'][prevTime]['4. close']) : price;
                const change = (price - prevPrice).toFixed(2);
                const percent = ((change / prevPrice) * 100).toFixed(2);
                return { price, change, percent };
            } catch (error) {
                console.error(`Error fetching ${symbol} data:`, error);
                return { price: 'N/A', change: 'N/A', percent: 'N/A' };
            }
        }

        async function updateCommodities() {
            const commodities = [
                { symbol: 'CL', name: 'WTI Crude', ids: ['wti-crude-price', 'wti-crude-change', 'wti-crude-percent'] },
                { symbol: 'BZ', name: 'Brent Crude', ids: ['brent-crude-price', 'brent-crude-change', 'brent-crude-percent'] },
                { symbol: 'RB', name: 'RBOB Gasoline', ids: ['rbob-gasoline-price', 'rbob-gasoline-change', 'rbob-gasoline-percent'] },
                { symbol: 'NG', name: 'Natural Gas', ids: ['natural-gas-price', 'natural-gas-change', 'natural-gas-percent'] },
                { symbol: 'HO', name: 'Heating Oil', ids: ['heating-oil-price', 'heating-oil-change', 'heating-oil-percent'] }
            ];

            for (const commodity of commodities) {
                const data = await fetchCommodityData(commodity.symbol);
                document.getElementById(commodity.ids[0]).textContent = data.price !== 'N/A' ? `$${data.price.toFixed(2)}` : 'N/A';
                document.getElementById(commodity.ids[1]).textContent = data.change !== 'N/A' ? data.change : 'N/A';
                document.getElementById(commodity.ids[2]).textContent = data.percent !== 'N/A' ? `${data.percent >= 0 ? '+' : ''}${data.percent}%` : 'N/A';
            }
        }

        const articlesData = [
            { id: 1, category: 'Crude Oil', title: 'Oil Prices Surge Amid Supply Concerns', date: 'May 5, 2025', source: 'Reuters', link: 'https://example.com/article-1', image: 'data:image/png;base64,...' },
            { id: 2, category: 'Natural Gas', title: 'Natural Gas Futures Rise', date: 'May 5, 2025', source: 'Bloomberg', link: 'https://example.com/article-2', image: 'data:image/png;base64,...' },
            { id: 3, category: 'Petrochemicals', title: 'Petrochemical Industry Faces New Regulations', date: 'May 4, 2025', source: 'Chemical Week', link: 'https://example.com/article-3', image: 'data:image/png;base64,...' },
            { id: 4, category: 'Power', title: 'Power Grid Upgrades Planned', date: 'May 4, 2025', source: 'Utility Dive', link: 'https://example.com/article-4', image: 'data:image/png;base64,...' },
            { id: 5, category: 'Renewables', title: 'Solar Energy Adoption Accelerates', date: 'May 3, 2025', source: 'PV Magazine', link: 'https://example.com/article-5', image: 'data:image/png;base64,...' },
            { id: 6, category: 'Company News', title: 'BP Announces New Exploration Project', date: 'May 3, 2025', source: 'Oil & Gas Journal', link: 'https://example.com/article-6', image: 'data:image/png;base64,...' },
            { id: 7, category: 'Earnings', title: 'Chevron Reports Strong Q1 Earnings', date: 'May 2, 2025', source: 'CNBC', link: 'https://example.com/article-7', image: 'data:image/png;base64,...' },
            { id: 8, category: 'Crude Oil', title: 'OPEC+ to Discuss Output Cuts', date: 'May 2, 2025', source: 'Wall Street Journal', link: 'https://example.com/article-8', image: 'data:image/png;base64,...' },
            { id: 9, category: 'Natural Gas', title: 'LNG Exports Hit Record High', date: 'May 1, 2025', source: 'S&P Global', link: 'https://example.com/article-9', image: 'data:image/png;base64,...' },
            { id: 10, category: 'Petrochemicals', title: 'New Petrochemical Plant Opens', date: 'May 1, 2025', source: 'ICIS', link: 'https://example.com/article-10', image: 'data:image/png;base64,...' },
            { id: 11, category: 'Power', title: 'Nuclear Plant Maintenance Scheduled', date: 'Apr 30, 2025', source: 'Power Engineering', link: 'https://example.com/article-11', image: 'data:image/png;base64,...' },
            { id: 12, category: 'Renewables', title: 'Wind Farm Expansion Approved', date: 'Apr 30, 2025', source: 'Renewable Energy World', link: 'https://example.com/article-12', image: 'data:image/png;base64,...' },
            { id: 13, category: 'Company News', title: 'Shell Invests in Carbon Capture', date: 'Apr 29, 2025', source: 'Energy Voice', link: 'https://example.com/article-13', image: 'data:image/png;base64,...' },
            { id: 14, category: 'Earnings', title: 'TotalEnergies Beats Profit Forecasts', date: 'Apr 29, 2025', source: 'Financial Times', link: 'https://example.com/article-14', image: 'data:image/png;base64,...' },
            { id: 15, category: 'Crude Oil', title: 'Brent Crude Hits $90', date: 'Apr 28, 2025', source: 'MarketWatch', link: 'https://example.com/article-15', image: 'data:image/png;base64,...' },
            { id: 16, category: 'Natural Gas', title: 'Gas Storage Levels Critically Low', date: 'Apr 28, 2025', source: 'Rystad Energy', link: 'https://example.com/article-16', image: 'data:image/png;base64,...' },
            { id: 17, category: 'Petrochemicals', title: 'Ethylene Prices Soar', date: 'Apr 27, 2025', source: 'Platts', link: 'https://example.com/article-17', image: 'data:image/png;base64,...' },
            { id: 18, category: 'Power', title: 'Coal Plant Closures Accelerate', date: 'Apr 27, 2025', source: 'Greentech Media', link: 'https://example.com/article-18', image: 'data:image/png;base64,...' },
            { id: 19, category: 'Earnings', title: 'Google Reports Record Earnings', date: 'May 3, 2025', source: 'Financial Times', link: 'https://example.com/article-19', image: 'data:image/png;base64,...' },
            { id: 20, category: 'Earnings', title: 'Microsoft Beats Earnings Expectations', date: 'May 3, 2025', source: 'BBC', link: 'https://example.com/article-20', image: 'data:image/png;base64,...' },
            { id: 21, category: 'Earnings', title: 'ExxonMobil Posts Strong Q1 Results', date: 'May 3, 2025', source: 'Reuters', link: 'https://example.com/article-21', image: 'data:image/png;base64,...' }
        ];

        const newsGrid = document.getElementById('newsGrid');
        let displayedArticles = articlesData;

        function displayArticles(articles) {
            newsGrid.innerHTML = '';
            articles.forEach(article => {
                const articleElement = document.createElement('article');
                articleElement.className = 'rounded-lg shadow-lg flex flex-col sm:flex-row items-start sm:items-center overflow-hidden';
                articleElement.setAttribute('data-category', article.category);
                articleElement.innerHTML = `
                    <img src="${article.image}" alt="${article.category}" class="news-image m-4 sm:m-0 sm:mr-4" loading="lazy">
                    <div class="p-4 flex-1">
                        <div class="flex justify-between items-start">
                            <div>
                                <h2 class="text-lg text-gray-800 hover:text-blue-400">
                                    <a href="${article.link}" target="_blank">${article.title}</a>
                                </h2>
                                <p class="text-gray-600 text-sm mt-1">${article.date} • ${article.source} <span class="category-tag">${article.category}</span></p>
                            </div>
                            <button class="favorite-btn mt-1" onclick="toggleFavorite(${article.id})">☆</button>
                        </div>
                    </div>
                `;
                newsGrid.appendChild(articleElement);
            });

            const storedFavorites = JSON.parse(localStorage.getItem('favorites')) || [];
            storedFavorites.forEach(id => {
                const button = document.querySelector(`button[onclick="toggleFavorite(${id})"]`);
                if (button) button.classList.add('favorited');
            });
        }

        window.addEventListener('load', () => {
            displayArticles(displayedArticles);
            updateTickerBanner();
            updateCommodities();
        });

        let favorites = JSON.parse(localStorage.getItem('favorites')) || [];
        const newsSection = document.getElementById('news');
        const favoritesSection = document.getElementById('favorites');
        const favoritesGrid = document.getElementById('favoritesGrid');

        function toggleFavorite(articleId) {
            const index = favorites.indexOf(articleId);
            const button = document.querySelector(`button[onclick="toggleFavorite(${articleId})"]`);
            if (index === -1) {
                favorites.push(articleId);
                button.classList.add('favorited');
            } else {
                favorites.splice(index, 1);
                button.classList.remove('favorited');
            }
            localStorage.setItem('favorites', JSON.stringify(favorites));
            updateFavoritesSection();
        }

        function updateFavoritesSection() {
            favoritesGrid.innerHTML = '';
            const favoritedArticles = displayedArticles.filter(article => favorites.includes(article.id));
            favoritedArticles.forEach(article => {
                const articleElement = document.createElement('article');
                articleElement.className = 'rounded-lg shadow-lg flex flex-col sm:flex-row items-start sm:items-center overflow-hidden';
                articleElement.setAttribute('data-category', article.category);
                articleElement.innerHTML = `
                    <img src="${article.image}" alt="${article.category}" class="news-image m-4 sm:m-0 sm:mr-4" loading="lazy">
                    <div class="p-4 flex-1">
                        <div class="flex justify-between items-start">
                            <div>
                                <h2 class="text-lg text-gray-800 hover:text-blue-400">
                                    <a href="${article.link}" target="_blank">${article.title}</a>
                                </h2>
                                <p class="text-gray-600 text-sm mt-1">${article.date} • ${article.source} <span class="category-tag">${article.category}</span></p>
                            </div>
                            <button class="favorite-btn mt-1 favorited" onclick="toggleFavorite(${article.id})">☆</button>
                        </div>
                    </div>
                `;
                favoritesGrid.appendChild(articleElement);
            });
        }

        document.querySelector('a[href="#favorites"]').addEventListener('click', () => {
            newsSection.classList.add('hidden');
            favoritesSection.classList.remove('hidden');
            updateFavoritesSection();
        });

        document.querySelector('a[href="#news"]').addEventListener('click', () => {
            showNewsSection();
        });

        function showNewsSection() {
            newsSection.classList.remove('hidden');
            favoritesSection.classList.add('hidden');
        }

        document.querySelectorAll('img').forEach(img => {
            img.onerror = function() {
                this.src = 'https://via.placeholder.com/150x100?text=Image+Not+Found';
                this.alt = 'Image Not Found';
            };
        });

        const marketTabs = document.querySelectorAll('.market-tab');
        const marketContents = document.querySelectorAll('.market-content');

        marketTabs.forEach(tab => {
            tab.addEventListener('click', () => {
                marketTabs.forEach(t => t.classList.remove('active'));
                tab.classList.add('active');
                marketContents.forEach(content => content.classList.remove('active'));
                const contentId = `market${tab.id.replace('tab', '')}Content`;
                document.getElementById(contentId).classList.add('active');
            });
        });

        function showTerms(event) {
            event.preventDefault();
            document.getElementById('termsContent').style.display = 'block';
        }

        function closeTerms() {
            document.getElementById('termsContent').style.display = 'none';
        }

        function showPrivacy(event) {
            event.preventDefault();
            document.getElementById('privacyContent').style.display = 'block';
        }

        function closePrivacy() {
            document.getElementById('privacyContent').style.display = 'none';
        }

        window.onclick = function(event) {
            if (event.target === document.getElementById('termsContent')) {
                closeTerms();
            }
            if (event.target === document.getElementById('privacyContent')) {
                closePrivacy();
            }
        };

        // Filter logic with charcoal black toggle
        const categoryButtons = document.querySelectorAll('.category');
        categoryButtons.forEach(btn => {
            btn.addEventListener('click', () => {
                btn.classList.toggle('bg-gray-800'); // Charcoal black
                btn.classList.toggle('text-white');
                btn.classList.toggle('border-gray-300');
                btn.classList.toggle('border-black');
                btn.classList.toggle('hover:bg-gray-900');

                const selectedCategories = Array.from(categoryButtons)
                    .filter(btn => btn.classList.contains('bg-gray-800'))
                    .map(btn => btn.getAttribute('data-category'));

                if (selectedCategories.length === 0) {
                    displayArticles(displayedArticles);
                } else {
                    const filteredArticles = displayedArticles.filter(article =>
                        selectedCategories.includes(article.category)
                    );
                    displayArticles(filteredArticles);
                }
            });
        });
    </script>
</body>
</html>
